<div class="content">
  <div class="panel">
    <div class="usersC">
        <app-specific-plan-for-mentor *ngIf="!is_student" [isLoadedUsers]="isLoadedUsers" [users]="users" (selectedUser)="selectedUserbyMentor($event)"></app-specific-plan-for-mentor>
      </div>
  </div>
  <div class="sections">
    <div class="section" *ngFor="let section of sections; let j = index">
      <mat-expansion-panel [expanded]='!isExpanded'>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <h2 mat-dialog-title>
            {{section.Name}}
            </h2>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="tasks" *ngFor="let t of section.Content.Tasks; let i = index">
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <div class="checkbox" *ngIf="is_student && section.Content.UsersTasks">
                  <mat-checkbox [disabled]="isTaskApproved(section.Content.UsersTasks[i].UserTasks[0].State) || isUserTaskExpiration(section.Content.UsersTasks[i].UserTasks[0])" id="{{section.Content.UsersTasks[i].UserTasks[0].Id}}"
                    (change)="sendState(j, i, $event)" [checked]="isChecked(section.Content.UsersTasks[i].UserTasks[0].State)"></mat-checkbox>
                </div>
                <span class="title">
                  {{t.Name}}
                </span>
                <div class="stateIcons" *ngIf="section.Content.UsersTasks">
                <div class="states" *ngFor="let s of section.Content.UsersTasks[i].UserTasks">
                  <img [src]="s.Image" width="20px" height="20px" style="padding-left: 20px"/>
                </div>
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="buttons" *ngIf="section.Content.UsersTasks">
              <div class="result">
                <button mat-raised-button class="button-change" (click)="onResultClick(section.Content.UsersTasks[i].UserTasks[selectedUser], section.Content.Tasks[i])">Result</button>
                <button mat-raised-button class="button-change" (click)="onConversationClick(section.Content.UsersTasks[i].UserTasks[selectedUser], section.Content.Tasks[i])">Conversation</button>
              </div>
              <div>
              <mat-form-field>
                <input matInput [min]="section.Content.UsersTasks[i].UserTasks[selectedUser].EndDate" [value]="section.Content.UsersTasks[i].UserTasks[selectedUser].EndDate" [matDatepicker]="picker" disabled>
                <mat-datepicker #picker disabled="false"></mat-datepicker>
              </mat-form-field>
              <button mat-raised-button (click)="onSuggestDeadlineClick(t.Name, section.Content.UsersTasks[i].UserTasks[selectedUser])">Suggest end date</button>
              </div>
              <div class="review" *ngIf="!is_student">
                <button mat-raised-button class="button-change" [disabled]="!isTaskDone(section.Content.UsersTasks[i].UserTasks[selectedUser].State)" (click)="approve(j, i)">Approve</button>
                <button mat-raised-button class="button-change" [disabled]="!isTaskDone(section.Content.UsersTasks[i].UserTasks[selectedUser].State)" (click)="reject(j, i)">Reject</button>
              </div>
            </div>
          </mat-expansion-panel>
        </div>
      </mat-expansion-panel>
    </div>
  </div>
</div>
